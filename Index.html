<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ختمتي | Quran Juz Tracker</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Inter for modern look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'IBM Plex Sans Arabic', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <!-- Main Application Container -->
    <div class="bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl max-w-xl w-full mx-4">
        <!-- Application Title -->
        <h1 class="text-4xl font-bold text-center mb-6 text-indigo-600 dark:text-indigo-400">
            ختمتي
        </h1>

        <!-- Subtitle -->
        <p class="text-center text-gray-600 dark:text-gray-400 mb-6">تتبع تقدمك في قراءة القرآن الكريم</p>

        <!-- Progress Bar -->
        <div class="mb-8">
            <div class="w-full bg-gray-200 rounded-full dark:bg-gray-700">
                <div id="progress-bar" class="bg-indigo-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full" style="width: 0%">0%</div>
            </div>
        </div>

        <!-- Juz' List Container -->
        <div id="juz-list" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            <!-- Checkboxes will be dynamically added here -->
        </div>

        <!-- Control Buttons Section -->
        <div class="flex justify-center mt-6">
            <!-- Reset Button -->
            <button id="reset-btn" class="px-6 py-2 rounded-full text-lg font-bold text-white bg-red-600 hover:bg-red-700 transition-colors duration-200 transform shadow-lg">
                إعادة ضبط
            </button>
        </div>

        <!-- Message Box -->
        <div id="message-box" class="mt-6 text-center text-sm font-medium text-gray-600 dark:text-gray-400"></div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const juzListContainer = document.getElementById('juz-list');
            const resetButton = document.getElementById('reset-btn');
            const messageBox = document.getElementById('message-box');
            const progressBar = document.getElementById('progress-bar');
            
            const totalJuz = 30;
            const localStorageKey = 'khatmatiJuzProgress';

            // Function to save the state of all checkboxes to local storage
            function saveProgress() {
                const progressState = {};
                for (let i = 1; i <= totalJuz; i++) {
                    const checkbox = document.getElementById(`juz-${i}`);
                    if (checkbox) {
                        progressState[i] = checkbox.checked;
                    }
                }
                localStorage.setItem(localStorageKey, JSON.stringify(progressState));
                updateProgressDisplay();
            }

            // Function to load the state of checkboxes from local storage
            function loadProgress() {
                const savedState = localStorage.getItem(localStorageKey);
                if (savedState) {
                    const progressState = JSON.parse(savedState);
                    for (const juzNumber in progressState) {
                        const checkbox = document.getElementById(`juz-${juzNumber}`);
                        if (checkbox) {
                            checkbox.checked = progressState[juzNumber];
                        }
                    }
                }
                updateProgressDisplay();
            }

            // Function to update the progress bar and percentage display
            function updateProgressDisplay() {
                let completedJuz = 0;
                for (let i = 1; i <= totalJuz; i++) {
                    const checkbox = document.getElementById(`juz-${i}`);
                    if (checkbox && checkbox.checked) {
                        completedJuz++;
                    }
                }
                const percentage = Math.round((completedJuz / totalJuz) * 100);
                progressBar.style.width = `${percentage}%`;
                progressBar.textContent = `${percentage}%`;

                if (completedJuz === totalJuz) {
                    showMessage("ما شاء الله! لقد أتممت ختم القرآن الكريم. مبارك!");
                }
            }

            // Function to display a message in the message box
            function showMessage(message) {
                messageBox.textContent = message;
                setTimeout(() => {
                    messageBox.textContent = "";
                }, 3000); // Clear message after 3 seconds
            }

            // Generate the list of Juz' with checkboxes
            function createJuzList() {
                for (let i = 1; i <= totalJuz; i++) {
                    const juzItem = document.createElement('div');
                    juzItem.classList.add('flex', 'items-center', 'space-x-2', 'rtl:space-x-reverse', 'p-2', 'rounded-lg', 'transition-colors', 'duration-200', 'hover:bg-gray-100', 'dark:hover:bg-gray-700', 'cursor-pointer');

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = `juz-${i}`;
                    checkbox.classList.add('form-checkbox', 'h-5', 'w-5', 'text-indigo-600', 'rounded', 'dark:text-indigo-400', 'focus:ring-indigo-500', 'dark:focus:ring-indigo-400');

                    const label = document.createElement('label');
                    label.htmlFor = `juz-${i}`;
                    label.textContent = `الجزء ${i}`;
                    label.classList.add('text-lg', 'font-medium', 'text-gray-700', 'dark:text-gray-300', 'cursor-pointer');

                    juzItem.appendChild(checkbox);
                    juzItem.appendChild(label);
                    juzListContainer.appendChild(juzItem);

                    // Add an event listener to each checkbox to save progress
                    checkbox.addEventListener('change', saveProgress);
                }
            }

            // Handle Reset button click
            resetButton.addEventListener('click', () => {
                // Use a custom message box for confirmation
                messageBox.innerHTML = `
                    <p class="mb-4">هل أنت متأكد من إعادة ضبط التقدم؟</p>
                    <button id="confirm-reset" class="px-4 py-2 rounded-full text-white bg-red-600 hover:bg-red-700 transition-colors duration-200">
                        نعم، أعد الضبط
                    </button>
                    <button id="cancel-reset" class="px-4 py-2 rounded-full text-white bg-gray-600 hover:bg-gray-700 ml-2 transition-colors duration-200">
                        إلغاء
                    </button>
                `;

                document.getElementById('confirm-reset').addEventListener('click', () => {
                    localStorage.removeItem(localStorageKey);
                    // Uncheck all boxes
                    for (let i = 1; i <= totalJuz; i++) {
                        const checkbox = document.getElementById(`juz-${i}`);
                        if (checkbox) {
                            checkbox.checked = false;
                        }
                    }
                    updateProgressDisplay();
                    showMessage("تمت إعادة ضبط التقدم.");
                });

                document.getElementById('cancel-reset').addEventListener('click', () => {
                    messageBox.innerHTML = "";
                });
            });

            // On initial load, create the list and load saved progress
            createJuzList();
            loadProgress();

        });
    </script>
</body>
</html>

  
